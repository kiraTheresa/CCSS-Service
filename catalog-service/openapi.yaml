openapi: 3.0.3
info:
  title: 课程目录服务API
  description: 课程目录服务提供管理课程信息的RESTful API
  version: 1.0.0
  contact:
    name: 开发者
    email: developer@example.com

servers:
  - url: http://localhost:8081
    description: 本地开发服务器

paths:
  /health:
    get:
      summary: 基本健康检查
      description: 获取服务的基本健康状态
      tags:
        - 健康检查
      responses:
        '200':
          description: 服务正常
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    description: 服务状态
                    example: "UP"
                  service:
                    type: string
                    description: 服务名称
                    example: "catalog-service"
                  timestamp:
                    type: string
                    description: 响应时间戳
                    example: "2024-01-01T12:00:00"
        '500':
          description: 服务异常
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    description: 服务状态
                    example: "DOWN"
                  service:
                    type: string
                    description: 服务名称
                    example: "catalog-service"
                  timestamp:
                    type: string
                    description: 响应时间戳
                    example: "2024-01-01T12:00:00"

  /health/detailed:
    get:
      summary: 详细健康检查
      description: 获取服务的详细健康信息
      tags:
        - 健康检查
      responses:
        '200':
          description: 服务正常
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    description: 服务状态
                    example: "UP"
                  service:
                    type: string
                    description: 服务名称
                    example: "catalog-service"
                  timestamp:
                    type: string
                    description: 响应时间戳
                    example: "2024-01-01T12:00:00"
                  version:
                    type: string
                    description: 服务版本
                    example: "1.0.0"
                  description:
                    type: string
                    description: 服务描述
                    example: "课程目录服务，提供课程管理功能"
                  endpoints:
                    type: object
                    description: 服务端点信息
                    additionalProperties:
                      type: string

  /api/courses:
    get:
      summary: 查询所有课程
      description: 获取课程目录中所有课程的列表
      tags:
        - 课程管理
      responses:
        '200':
          description: 查询成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
    post:
      summary: 创建新课程
      description: 在课程目录中创建一门新课程
      tags:
        - 课程管理
      requestBody:
        description: 要创建的课程对象
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Course'
      responses:
        '201':
          description: 课程创建成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '400':
          description: 无效的输入数据
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'

  /api/courses/{id}:
    get:
      summary: 根据ID查询课程
      description: 根据课程的UUID查询特定课程
      tags:
        - 课程管理
      parameters:
        - name: id
          in: path
          description: 要查询的课程UUID
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: 查询成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '404':
          description: 课程不存在
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
    put:
      summary: 更新课程信息
      description: 根据课程的UUID更新现有课程
      tags:
        - 课程管理
      parameters:
        - name: id
          in: path
          description: 要更新的课程UUID
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        description: 更新后的课程对象
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Course'
      responses:
        '200':
          description: 课程更新成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '400':
          description: 无效的输入数据
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '404':
          description: 课程不存在
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
    delete:
      summary: 删除课程
      description: 根据课程的UUID删除课程
      tags:
        - 课程管理
      parameters:
        - name: id
          in: path
          description: 要删除的课程UUID
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: 课程删除成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '404':
          description: 课程不存在
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'

  /api/courses/code/{code}:
    get:
      summary: 根据课程编号查询课程
      description: 根据课程的唯一编号查询课程
      tags:
        - 课程管理
      parameters:
        - name: code
          in: path
          description: 要查询的课程编号
          required: true
          schema:
            type: string
            maxLength: 20
      responses:
        '200':
          description: 查询成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '404':
          description: 课程不存在
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'

  /api/courses/instructor/{instructorId}:
    get:
      summary: 根据教师ID查询课程
      description: 查询特定教师教授的所有课程
      tags:
        - 课程管理
      parameters:
        - name: instructorId
          in: path
          description: 教师的ID
          required: true
          schema:
            type: string
      responses:
        '200':
          description: 查询成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '400':
          description: 无效的教师ID
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'

  /api/courses/search:
    get:
      summary: 根据标题搜索课程
      description: 根据标题关键词搜索课程
      tags:
        - 课程管理
      parameters:
        - name: keyword
          in: query
          description: 课程标题搜索关键词
          required: true
          schema:
            type: string
      responses:
        '200':
          description: 查询成功
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '400':
          description: 无效的搜索关键词
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        '500':
          description: 服务器内部错误
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'

components:
  schemas:
    ApiResponse:
      type: object
      properties:
        code:
          type: integer
          description: HTTP状态码
          example: 200
        message:
          type: string
          description: 响应消息
          example: "成功"
        data:
          oneOf:
            - $ref: '#/components/schemas/Course'
            - type: array
              items:
                $ref: '#/components/schemas/Course'
            - type: null

    Course:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: 唯一标识符
          example: "550e8400-e29b-41d4-a716-446655440000"
        code:
          type: string
          description: 课程编号（例如："CS101"）
          maxLength: 20
          example: "CS101"
        title:
          type: string
          description: 课程标题
          maxLength: 100
          example: "计算机科学导论"
        instructorId:
          type: string
          description: 教师ID
          example: "INS001"
        scheduleId:
          type: string
          description: 排课ID
          example: "SCH001"
        capacity:
          type: integer
          description: 最大选课人数
          minimum: 1
          maximum: 500
          example: 50
        createdAt:
          type: string
          format: date-time
          description: 创建时间戳
          example: "2024-01-01T12:00:00"
        enrolled:
          type: integer
          description: 当前选课人数
          minimum: 0
          example: 0
        description:
          type: string
          description: 课程描述
          maxLength: 1000
          example: "计算机科学入门课程"
        credits:
          type: integer
          description: 课程学分
          minimum: 0
          maximum: 10
          example: 3
        location:
          type: string
          description: 上课地点
          maxLength: 200
          example: "教室101"
      required:
        - code
        - title
        - instructorId
        - scheduleId
        - capacity